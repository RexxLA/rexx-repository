\hypertarget{configuration}{%
\chapter{Configuration}\label{configuration}}

Any implementation of this standard will be functioning within a
configuration. In practice, the boundary between what is implemented
especially to support Rexx and what is provided by the system will vary
from system to system. This clause describes what they shall together do
to provide the configuration for the Rexx language processing which is
described in this standard.

We don't want to add undue ``magic'' to this section. It seems we will
need the concept of a ``reference'' (equivalent to a machine address) so
that this section can at least have composite objects as arguments. (As
it already does but these are not Rexx objects)

Possibly we could unify ``reference'' with ``variable pool number''
since object one-to-one with its variable pool is a fair model. That way
we don't need a new primitive for comparison of two references.

JAVA is only a ``reference'' for NetRexx so some generalized JAVA-like
support is needed for that. It would provide the answers to what classes
were in the context, what their method signatures were etc.

\hypertarget{notation}{%
\section{Notation}\label{notation}}

The interface to the configuration is described in terms of functions.
The notation for describing the interface functionally uses the name
given to the function, followed by any arguments. This does not
constrain how a specific implementation provides the function, nor does
it imply that the order of arguments is significant for a specific
implementation.

The names of the functions are used throughout this standard; the names
used for the arguments are used only in this clause and nnn.

The name of a function refers to its usage. A function whose name starts
with

\begin{itemize}
\item
  Config\_ is used only from the language processor when processing
  programs;
\item
  API\_is part of the application programming interface and is
  accessible from programs which are not written in the Rexx language;
\item
  Trap\_ is not provided by the language processor but may be invoked by
  the language processor. As its result, each function shall return a
  completion Response. This is a string indicating how the function
  behaved. The completion response may be the character `N' indicating
  the normal behavior occurred; otherwise the first character is an
  indicator of a different behavior and the remainder shall be suitable
  as a human-readable description of the function's behavior.
\end{itemize}

This standard defines any additional results from Config\_ functions as
made available to the language processor in variables. This does not
constrain how a particular implementation should return these results.

\hypertarget{notation-for-completion-response-and-conditions}{%
\subsection{Notation for completion response and
conditions}\label{notation-for-completion-response-and-conditions}}

As alternatives to the normal indicator `N', each function may return a
completion response with indicator 'X' or `S'; other possible indicators
are described for each function explicitly. The indicator `X' means that
the function failed because resources were exhausted. The indicator `S'
shows that the configuration was unable to perform the function. Certain
indicators cause conditions to be raised. The possible raising of these
conditions is implicit in the use of the function; it is not shown
explicitly when the functions are used in this standard. The implicit
action is call \#Raise `SYNTAX', Message, Description where: \#Raise
raises the condition, see nnn. Message is determined by the indicator in
the completion response. If the indicator is `X' then Message is 5.1. If
the indicator is `S' then Message is 48.1. Description is the
description in the completion response. The `SYNTAX' condition 5.1 can
also be raised by any other activity of the language processor.

\hypertarget{processing-initiation}{%
\section{Processing initiation}\label{processing-initiation}}

The processing initiation interface consists of a function which the
configuration shall provide to invoke the language processor. We could
do REQUIRES in a macro-expansion way by adding an argument to
Contig\_SourceChar to specify the source file. However, I'm assuming we
will prefer to recursively ``run'' each required file. One of the
results of that will be the classes and methods made public by that
REQUIRES subject.

\hypertarget{api-start}{%
\subsection{API Start}\label{api-start}}

Syntax:

API Start(How, Source, Environment, Arguments, Streams, Traps, Provides)

where: How is one of `COMMAND', `FUNCTION', or `SUBROUTINE' and
indicates how the program is invoked.

What does OOI say for How when running REQUIREd files?

Source is an identification of the source of the program to be
processed.

Environment is the initial value of the environment to be used in
processing commands. This has components for the name of the environment
and how the input and output of commands is to be directed.

Arguments is the initial argument list to be used in processing. This
has components to specify the number of arguments, which arguments are
omitted, and the values of arguments that are not omitted.

Streams has components for the default input stream to be used and the
default output streams to be used.

Traps is the list of traps to be used in processing (see nnn). This has
components to specify whether each trap is omitted or not.

Semantics:

This function starts the execution of a Rexx program.

If the program was terminated due to a RETURN or EXIT instruction
without an expression the completion response is `N'.

If the program was terminated due to a RETURN or EXIT instruction with
an expression the indicator in the completion response is `R' and the
description of the completion response is the value of the expression.

If the program was terminated due to an error the indicator in the
completion response is `E' and the description in the completion
response comprises information about the error that terminated
processing.

If How was `REQUIRED' and the completion response was not `E', the
Provides argument is set to reference classes made available. See nnn
for the semantics of these classes.

\hypertarget{source-programs-and-character-sets}{%
\section{Source programs and character
sets}\label{source-programs-and-character-sets}}

The configuration shall provide the ability to access source programs
(see nnn). Source programs consist of characters belonging to the
following categories:

\begin{itemize}
\item
  syntactic\_characters;
\item
  extra\_letters;
\item
  other\_blank\_characters;
\item
  other\_negators;
\item
  other\_characters.
\end{itemize}

A character shall belong to only one category.

\hypertarget{syntactic_characters}{%
\subsection{Syntactic\_characters}\label{syntactic_characters}}

The following characters represent the category of characters called
syntactic\_characters, identified by their names. The glyphs used to
represent them in this document are also shown. Syntactic\_characters
shall be available in every configuration:

\begin{itemize}
\item
  \& ampersand;
\item
  apostrophe, single quotation mark, single quote;
\item
  asterisk, star;
\item
  blank, space;
\item
  A-Z capital letters A through Z;
\item
  colon;
\item
  , comma;
\item
  0-9 digits zero through nine;
\item
  = equal sign;
\item
  exclamation point, exclamation mark;
\item
  \begin{quote}
  greater-than sign;
  \end{quote}
\end{itemize}

hyphen, minus sign;

\textless{} less-than sign;

\begin{itemize}
\item
  {[} left bracket, left square bracket; (\_ left parenthesis;
\item
  \% percent sign;
\item
  . period, decimal point, full stop, dot;
\item
  plus sign;
\item
  ? question mark;
\item
  '' quotation mark, double quote; ~reverse slant, reverse solidus,
  backslash; {]} right bracket, right square bracket;
\item
  ) right parenthesis; ; semicolon; /\_ slant, solidus, slash; a-z small
  letters a through z;
\item
  \textasciitilde{} tilde, twiddle;
\item
  \_ underline, low line, underscore;
\item
  vertical line, bar, vertical bar.
\end{itemize}

\hypertarget{extra_letters}{%
\subsection{Extra\_letters}\label{extra_letters}}

A configuration may have a category of characters in source programs
called extra\_letters. Extra\_letters are determined by the
configuration.

\hypertarget{other_blank_characters}{%
\subsection{Other\_blank\_characters}\label{other_blank_characters}}

A configuration may have a category of characters in source programs
called other\_blank\_characters. Other\_blank\_characters are determined
by the configuration. Only the following characters represent possible
characters of this category:

\begin{itemize}
\item
  carriage return;
\item
  form feed;
\item
  horizontal tabulation;
\item
  new line;
\item
  vertical tabulation.
\end{itemize}

\hypertarget{other_negators}{%
\subsection{Other\_negators}\label{other_negators}}

A configuration may have a category of characters in source programs
called other\_negators. Other\_negators are determined by the
configuration. Only the following characters represent possible
characters of this category. The glyphs used to represent them in this
document are also shown:

\begin{itemize}
\item
  \begin{itemize}
  \tightlist
  \item
    circumflex accent, caret;
  \end{itemize}
\item
  --- not sign.
\end{itemize}

\hypertarget{other_characters}{%
\subsection{Other\_characters}\label{other_characters}}

A configuration may have a category of characters in source programs
called other\_characters. Other\_characters are determined by the
configuration.

\hypertarget{configuration-characters-and-encoding}{%
\section{Configuration characters and
encoding}\label{configuration-characters-and-encoding}}

The configuration characters and encoding interface consists of
functions which the configuration shall provide which are concerned with
the encoding of characters. The following functions shall be provided:

\begin{itemize}
\item
  Config\_SourceChar;
\item
  Config\_OtherBlankCharacters;
\item
  Config\_Upper;
\item
  Config\_Compare;
\item
  Config\_B2C;
\item
  Config\_C2B;
\item
  Config\_Substr;
\item
  Config\_Length;
\item
  Config\_Xrange.
\end{itemize}

\hypertarget{config_sourcechar}{%
\subsection{Config\_SourceChar}\label{config_sourcechar}}

Syntax:

Config SourceChar ()

Semantics: Supply the characters of the source program in sequence,
together with the EOL and EOS events. The EOL event represents the end
of a line. The EOS event represents the end of the source program. The
EOS event must only occur immediately after an EOL event. Either a
character or an event is supplied on each invocation, by setting
\#Outcome.

If this function is unable to supply a character because the source
program encoding is incorrect the indicator of the completion response
is `E' and the description of the completion information is the encoding
which is incorrect, in hexadecimal notation.

\hypertarget{config_otherblankcharacters}{%
\subsection{Config\_OtherBlankCharacters}\label{config_otherblankcharacters}}

Syntax: Config OtherBlankCharacters ()

Semantics: Get other\_blank\_characters (see nnn). Set \#Outcome to a
string of zero or more distinct characters in arbitrary order. Each
character is one that the configuration considers equivalent to the
character Blank for the purposes of parsing.

\hypertarget{config_upper}{%
\subsection{Config\_Upper}\label{config_upper}}

Syntax: Config Upper (Character)

where: Character is the character to be translated to uppercase.
Semantics: Translate Character to uppercase. Set \#Outcome to the
translated character. Characters which have been subject to this
translation are referred to as being in uppercase. Config\_Upper applied
to a character in uppercase must not change the character.

\hypertarget{config_lower}{%
\subsection{Config\_Lower}\label{config_lower}}

Syntax:

Config Lower (Character) where: Character is the character to be
translated to lowercase. Semantics: Translate Character to lowercase.
Set \#Outcome to the translated character. Characters which have been
subject to this translation are referred to as being in lowercase.
Config\_Lower applied to a character in lowercase must not change the
character. Config\_Upper of the outcome of Config\_Lower(Character)
shall be the original character.

\hypertarget{config_compare}{%
\subsection{Config\_Compare}\label{config_compare}}

Syntax: Config Compare(Characterl, Character2)

where:

Character1 is the character to be compared with Character2. Character2
is the character to be compared with Character1.

Semantics:

Compare two characters. Set \#Outcome to

\begin{itemize}
\item
  `equal' if Character1 is equal to Character2;
\item
  `greater' if Character1 is greater than Character2;
\item
  `lesser' if Character' is less than Character2. The function shall
  exhibit the following characteristics. If Config \_Compare(a,b)
  produces
\item
  `equal' then Config\_Compare(b,a) produces `equal';
\item
  `greater' then Config\_Compare(b,a) produces `lesser';
\item
  `lesser' then Config\_Compare(b,a) produces `greater';
\item
  `equal' and Config\_Compare(b,c) produces `equal' then
  Config\_Compare(a,c) produces `equal';
\item
  `greater' and Config\_Compare(b,c) produces `greater' then Config
  \_Compare(a,c) produces `greater';
\item
  `lesser' and Config \_Compare(b,c) produces `lesser' then
  Config\_Compare(a,c) produces `lesser';
\item
  `equal' then Config\_Compare(a,c) and Config\_Compare(b,c) produce the
  same value. Syntactic characters which are different characters shall
  not compare equal by Config\_Compare, see nnn.
\end{itemize}

\hypertarget{config-_b2c}{%
\subsection{Config \_B2C}\label{config-_b2c}}

Syntax: Config B2C (Binary) where: Binary is a sequence of digits, each
`0' or `1'. The number of digits shall be a multiple of eight.
Semantics:

Translate Binary to a coded string. Set \#Outcome to the resulting
string. The string may, or may not, correspond to a sequence of
characters.

\hypertarget{config_c2b}{%
\subsection{Config\_C2B}\label{config_c2b}}

Syntax: Config C2B (String)

where: String is a string. Semantics: Translate String to a sequence of
digits, each `0' or `1'. Set \#Outcome to the result. This function is
the inverse of Config\_B2C.

\hypertarget{config_substr}{%
\subsection{Config\_Substr}\label{config_substr}}

Syntax: Config Substr(String, n)

where: String is a string. nis an integer identifying a position within
String. Semantics: Copy the n-th character from String. The leftmost
character is the first character. Set Outcome to the resulting
character. If this function is unable to supply a character because
there is no n-th character in String the indicator of the completion
response is `M'. If this function is unable to supply a character
because the encoding of String is incorrect the indicator of the
completion response is `E' and the description of the completion
information is the encoding which is incorrect, in hexadecimal notation.

\hypertarget{config-length}{%
\subsection{Config Length}\label{config-length}}

Syntax: Config Length (String)

where: String is a string. Semantics: Set \#Outcome to the length of the
string, that is, the number of characters in the string. If this
function is unable to determine a length because the encoding of String
is incorrect, the indicator of the completion response is `E' and the
description of the completion information is the encoding which is
incorrect, in hexadecimal notation.

\hypertarget{config_xrange}{%
\subsection{Config\_Xrange}\label{config_xrange}}

Syntax:

Config Xrange(Characterl, Character2) where: Character1 is the null
string, or a single character. Character2 is the null string, or a
single character. Semantics: If Character1 is the null string then let
LowBound be a lowest ranked character in the character set according to
the ranking order provided by Config\_Compare; otherwise let LowBound be
Character1. If Character2 is the null string then let HighBound be a
highest ranked character in the character set according to the ranking
order provided by Config\_Compare; otherwise let HighBound be
Character2lf \#Outcome after Config\_Compare(LowBound,HighBound) has a
value of

\begin{itemize}
\item
  `equal' then \#Outcome is set to LowBound;
\item
  `lesser' then \#Outcome is set to the sequence of characters between
  LowBound and HighBound inclusively, in ranking order;
\item
  `greater' then \#Outcome is set to the sequence of characters
  HighBound and larger, in ranking order, followed by the sequence of
  characters LowBound and smaller, in ranking order.
\end{itemize}

\hypertarget{objects}{%
\section{Objects}\label{objects}}

The objects interface consists of functions which the configuration
shall provide for creating objects.

\hypertarget{config_objectnew}{%
\subsection{Config\_ObjectNew}\label{config_objectnew}}

Syntax: Config ObjectNew

Semantics:

Set \#Outcome to be a reference to an object. The object shall be
suitable for use as a variable pool, see nnn. This function shall never
return a value in \#Outcome which compares equal with the value returned
on another invokation of the function.

\hypertarget{config_array_size}{%
\subsection{Config\_Array\_Size}\label{config_array_size}}

Syntax: Config Array Size(Object, size) where: Object is an object. Size
is an integer greater or equal to 0. Semantics: The configuration should
prepare to deal efficiently with the object as an array with indexes
having values up to the value of size.

\hypertarget{config_array_put}{%
\subsection{Config\_Array\_Put}\label{config_array_put}}

Syntax: Config Array Put(Array, Item, Index)

where: Array is an array. Item is an object Index is an integer greater
or equal to 1. Semantics: The configuration shall record that the array
has Item associated with Index.

\hypertarget{config_array_at}{%
\subsection{Config\_Array\_At}\label{config_array_at}}

Syntax: Config Array At(Array, Index)

where: Array is an array. Index is an integer greater or equal to 1.
Semantics: The configuration shall return the item that the array has
associated with Index.

\hypertarget{config_array_hasindex}{%
\subsection{Config\_Array\_Hasindex}\label{config_array_hasindex}}

Syntax: Config Array At(Array, Index) where: Array is an array. Index is
an integer greater or equal to 1. Semantics: Return `1' if there is an
item in Array associated with Index, `0' otherwise.

\hypertarget{config_array_remove}{%
\subsection{Config\_Array\_Remove}\label{config_array_remove}}

Syntax: Config Array At(Array, Index)

where: Array is an array. Index is an integer greater or equal to 1.
Semantics: After this operation, no item is associated with the Index in
the Array.

\hypertarget{commands}{%
\section{Commands}\label{commands}}

The commands interface consists of a function which the configuration
shall provide for strings to be passed as commands to an environment.

See nnn and nnn for a description of language features that use
commands.

\hypertarget{config-_command}{%
\subsection{Config \_Command}\label{config-_command}}

Syntax:

Config Command(Environment, Command) where: Environment is the
environment to be addressed. It has components for:

\begin{itemize}
\item
  the name of the environment;
\item
  the name of a stream from which the command will read its input. The
  null string indicates use of the default input stream;
\item
  the name of a stream onto which the command will write its output. The
  null string indicates use of the default output stream. There is an
  indication of whether writing is to APPEND or REPLACE;
\item
  the name of a stream onto which the command will write its error
  output. The null string indicates use of the default error output
  stream. There is an indication of whether writing is to APPEND or
  REPLACE. Command is the command to be executed. Semantics: Perform a
  command.
\item
  set the indicator to `E' or `F' if the command ended with an ERROR
  condition, or a FAILURE condition, respectively;
\item
  set \#RC to the return code string of the command.
\end{itemize}

\hypertarget{external-routines}{%
\section{External routines}\label{external-routines}}

The external routines interface consists of a function which the
configuration shall provide to invoke external routines. See nnn and nnn
for a description of the language features that use external routines.

\hypertarget{config_externalroutine}{%
\subsection{Config\_ExternalRoutine}\label{config_externalroutine}}

Syntax: Config ExternalRoutine(How, NameType, Name, Environment,
Arguments, Streams, Traps) where: How is one of `FUNCTION' or
`SUBROUTINE' and indicates how the external routine is to be invoked.

NameType is a specification of whether the name was provided as a symbol
or as a string literal. Name is the name of the routine to be invoked.

Environment is an environment value with the same components as on API\_
Start.

Arguments is a specification of the arguments to the routine, with the
same components as on API Start.

Streams is a specification of the default streams, with the same
components as on API\_ Start.

Traps is the list of traps to be used in processing, with the same
components as on API\_ Start.

Semantics:

Invoke an external routine. Set \{Outcome to the result of the external
routine, or set the indicator of the completion response to `D' if the
external routine did not provide a result.

If this function is unable to locate the routine the indicator of the
completion response is `U'. As a result SYNTAX condition 43.1 is raised
implicitly.

If How indicated that a result from the routine was required but the
routine did not provide one the indicator of the completion response is
`H'. As a result SYNTAX condition 44.1 is raised implicitly.

If How indicated that a result from the routine was required but the
routine provided one that was too long (see \#Limit\_String in nnn) the
indicator of the completion response is `L'. As a result SYNTAX
condition 52 is raised implicitly.

If the routine failed in a way not indicated by some other indicator the
indicator of the completion response is `F'. As a result SYNTAX
condition 40.1 is raised implicitly.

\hypertarget{config_externalmethod}{%
\subsection{Config\_ExternalMethod}\label{config_externalmethod}}

OOI has external classes explicitly via the ::CLASS abc EXTERNAL
mechanism. Analogy with classic would also allow the subject of
::REQUIRES to be coded in non-Rexx. However ::REQUIRES subject is coded,
we need to gather in knowledge of its method names because of the search
algorithm that determines which method is called. Hence reasonable that
the ultimate external call is to a method. Perhaps combine
Config\_ExternalRoutine with Config\_ExternalMethod. There is a
terminology clash on ``environment''. Perhaps easiest to change the
classic to ``address\_environment''. (And make it part of new
``environment''?) There are terminology decisions to make about
``files'', ``programs'', and ``packages''. Possibly ``program'' is the
thing you run (and we don't say what it means physically), ``file'' is a
unit of scope (ROUTINEs in current file before those in REQUIREd), and
``package'' we don't use (since a software package from a shop would
probably have several files but not everything to run a program.) Using
``file'' this way may not be too bad since we used ``stream'' rather
than ``tile'' in the classic definition. The How parameter will need
`METHOD' as a value. Should API\_Start also allow 'METHOD''. If we pass
the new Environment we don't have to pass Streams separately.

Text of Config\_ExternalMethod waiting on such decisions. Syntax:

Config ExternalMethod (How, NameType, Name, Environment, Arguments,
Streams, Traps) where: How is one of `FUNCTION' or `SUBROUTINE' and
indicates how the external routine is to be invoked. NameType is a
specification of whether the name was provided as a symbol or as a
string literal. Name is the name of the routine to be invoked.
Environment is an environment value with the same components as on API\_
Start. Arguments is a specification of the arguments to the routine,
with the same components as on API\_Start. Streams is a specification of
the default streams, with the same components as on API\_ Start. Traps
is the list of traps to be used in processing, with the same components
as on API\_ Start. Semantics: Invoke an external routine. Set \{Outcome
to the result of the external routine, or set the indicator of the
completion response to `D' if the external routine did not provide a
result. If this function is unable to locate the routine the indicator
of the completion response is `U'. As a result SYNTAX condition 43.1 is
raised implicitly. If How indicated that a result from the routine was
required but the routine did not provide one the indicator of the
completion response is `H'. As a result SYNTAX condition 44.1 is raised
implicitly. If How indicated that a result from the routine was required
but the routine provided one that was too long (see \#Limit\_String in
nnn) the indicator of the completion response is `L'. As a result SYNTAX
condition 52 is raised implicitly. If the routine failed in a way not
indicated by some other indicator the indicator of the completion
response is `F'. As a result SYNTAX condition 40.1 is raised implicitly.
5.8 External data queue The external data queue interface consists of
functions which the configuration shall provide to manipulate an
external data queue mechanism. See nnn, nnn, nnn, nnn, and nnn for a
description of language features that use the external data queue. The
configuration shall provide an external data queue mechanism. The
following functions shall be provided:

\begin{itemize}
\item
  Config\_Push;
\item
  Config \_Queue;
\item
  Config\_ Pull;
\item
  Config\_Queued.
\end{itemize}

The configuration may permit the external data queue to be altered in
other ways. In the absence of such alterations the external data queue
shall be an ordered list. Config\_Push adds the specified string to one
end of the list, Config \_Queue to the other. Config\_Pull removes a
string from the end that Config\_Push adds to unless the list is empty.

\hypertarget{config-push}{%
\subsection{Config Push}\label{config-push}}

Syntax: Config Push(String)

where: String is the value to be retained in the external data queue.
Semantics: Add String as an item to the end of the external data queue
from which Config\_Pull will remove an item.

\hypertarget{contig_queue}{%
\subsection{Contig\_Queue}\label{contig_queue}}

Syntax: Config Queue (String)

where: String is the value to be retained in the external data queue.
Semantics: Add String as an item to the opposite end of the external
data queue from which Config\_Pull will remove an item.

\hypertarget{config_pull}{%
\subsection{Config\_Pull}\label{config_pull}}

Syntax: Config Pull()

Semantics: Retrieve an item from the end of the external data queue to
which Config\_Push adds an element to the list. Set \#Outcome to the
value of the retrieved item. If no item could be retrieved the indicator
of the completion response is `F'.

\hypertarget{contig_queued}{%
\subsection{Contig\_Queued}\label{contig_queued}}

Syntax: Config Queued ()

Semantics:

Get the count of items in the external data queue. Set \#Outcome to that
number.

\hypertarget{streams}{%
\section{Streams}\label{streams}}

The streams interface consists of functions which the configuration
shall provide to manipulate streams. See nnn, nnn, and nnn for a
description of language features which use streams. Streams are
identified by names and provide for the reading and writing of data.
They shall support the concepts of characters, lines, positioning,
default input stream and default output stream. The concept of a
persistent stream shall be supported and the concept of a transient
stream may be supported. A persistent stream is one where the content is
not expected to change except when the stream is explicitly acted on. A
transient stream is one where the data available is expected to vary
with time.

The concepts of binary and character streams shall be supported. The
content of a character stream is expected to be characters. The null
string is used as a name for both the default input stream and the
default output stream. The null string names the default output stream
only when it is an argument to the Config\_Stream\_Charout operation.

The following functions shall be provided:

\begin{itemize}
\item
  Config\_Stream\_Charin;
\item
  Config\_Stream\_Position;
\item
  Config\_Stream\_Command;
\item
  Config\_Stream\_State;
\item
  Config\_Stream\_Charout;
\item
  Config\_Stream\_Qualified;
\item
  Config\_Stream\_Unique;
\item
  Config\_Stream\_Query;
\item
  Config\_Stream\_Close;
\item
  Config\_Stream\_Count. The results of these functions are described in
  terms of the following stems with tails which are stream names:
\item
  \#Charin\_Position.Stream;
\item
  \#Charout\_Position.Stream;
\item
  \#Linein\_Position.Stream;
\item
  \#Lineout\_Position.Stream.
\end{itemize}

\hypertarget{config-_stream_charin}{%
\subsection{Config \_Stream\_Charin}\label{config-_stream_charin}}

Syntax:

Config Stream Charin(Stream, OperationType) where: Stream is the name of
the stream to be processed. OperationType is one of `CHARIN', `LINEIN',
or `NULL. Semantics: Read from a stream. Increase
\#Linein\_Position.Stream by one when the end-of-line indication is
encountered. Increase \#Charin\_Position.Stream when the indicator will
be 'N'. If OperationType is `CHARIN' the state variables describing the
stream will be affected as follows: - when the configuration is able to
provide data from a transient stream or the character at position
\#Charin\_Position.Stream of a persistent stream then \#Outcome shall be
set to contain the data. The indicator of the response shall be `N';

\begin{itemize}
\tightlist
\item
  when the configuration is unable to return data because the read
  position is at the end of a persistent stream then the indicator of
  the response shall be `O';
\item
  when the configuration is unable to return data from a transient
  stream because no data is available and no data is expected to become
  available then the indicator of the response shall be `O':
\item
  otherwise the configuration is unable to return data and does not
  expect to be able to return data by waiting; the indicator of the
  response shall be `E'. The data set in \#Outcome will either be a
  single character or will be a sequence of eight characters, each `0'
  or `1'. The choice is decided by the configuration. The eight
  character sequence indicates a binary stream, see nnn. If
  OperationType is `LINEIN' then the action is the same as if Operation
  had been `CHARIN' with the following additional possibility. If
  end-of-line is detected any character (or character sequence) which is
  an embedded indication of the end-of-line is skipped. The characters
  skipped contribute to the change of \#Charin\_Position.Stream.
  \#Outcome is the null string. If OperationType is `NULL' then the
  stream is accessed but no data is read.
\end{itemize}

\hypertarget{config_stream_position}{%
\subsection{Config\_Stream\_Position}\label{config_stream_position}}

Syntax:

Config Stream Position(Stream, OperationType, Position) where: Stream is
the name of the stream to be processed. Operation is `CHARIN', `LINEIN',
`CHAROUT', or `LINEOUT'. Position indicates where to position the
stream. Semantics: If the operation is `CHARIN' or `CHAROUT' then
Position is a character position, otherwise Position is a line position.
If Operation is `CHARIN' or `LINEIN' and the Position is beyond the
limit of the existing data then the indicator of the completion response
shall be `R'. Otherwise if Operation is `CHARIN' or `LINEIN' set
\#Charin\_Position.Stream to the position from which the next
Config\_Stream\_Charin on the stream shall read, as indicated by
Position. Set \#Linein\_Position.Stream to correspond with this
position. If Operation is `CHAROUT' or `LINEOQUT' and the Position is
more than one beyond the limit of existing data then the indicator of
the response shall be `R'. Otherwise if Operation is `CHAROUT' or
`LINEOUT' then \#Charout\_Position.Stream is set to the position at
which the next Config\_Stream\_Charout on the stream shall write, as
indicated by Position. Set \#Lineout\_Position.Stream to correspond with
this position. If this function is unable to position the stream because
the stream is transient then the indicator of the completion response
shall be `T'.

\hypertarget{config-_stream_command}{%
\subsection{Config \_Stream\_Command}\label{config-_stream_command}}

Syntax:

Config Stream Command (Stream, Command) where: Stream is the name of the
stream to be processed. Command is a configuration-specific command to
be performed against the stream. Semantics: Issue a
configuration-specific command against a stream. This may affect all
state variables describing Stream which hold position information. It
may alter the effect of any subsequent operation on the specified
stream. If the indicator is set to `N', \#Outcome shall be set to
information from the command.

\hypertarget{config_stream_state}{%
\subsection{Config\_Stream\_State}\label{config_stream_state}}

Syntax:

Config Stream State (Stream) where: Stream is the name of the stream to
be queried. Semantics: Set the indicator to reflect the state of the
stream. Return an indicator equal to the indicator that an immediately
subsequent Config\_Stream\_Charin(Stream, `CHARIN') would return.
Alternatively, return an indicator of `U'.

The remainder of the response shall be a configuration-dependent
description of the state of the stream.

\hypertarget{config_stream_charout}{%
\subsection{Config\_Stream\_Charout}\label{config_stream_charout}}

Syntax:

Config Stream Charout (Stream, Data) where: Stream is the name of the
stream to be processed. Data is the data to be written, or `EOL' to
indicate that an end-of-line indication is to be written, or a null
string. In the first case, if the stream is a binary stream then Data
will be eight characters, each `0' or `1', otherwise Data will be a
single character. Semantics: When Data is the null string, no data is
written. Otherwise write to the stream. The state variables describing
the stream will be affected as follows:

\begin{itemize}
\item
  when the configuration is able to write Data to a transient stream or
  at position \#Charout\_Position.Stream of a persistent stream then the
  indicator in the response shall be `N'. When Data is not `EOL' then
  \#Charout\_Position.Stream is increased by one. When Data is `EOL',
  then \#Lineout\_Position.Stream is increased by one and
  \#Charout\_Position.Stream is increased as necessary to account for
  any end-of-line indication embedded in the stream;
\item
  when the configuration is unable to write Data the indicator is set to
  `E'.
\end{itemize}

\hypertarget{config_stream_qualified}{%
\subsection{Config\_Stream\_Qualified}\label{config_stream_qualified}}

Syntax:

Config Stream Qualified (Stream) where: Stream is the name of the stream
to be processed. Semantics: Set \#Outcome to some name which identifies
Stream. Return a completion response with indicator `B' if the argument
is not acceptable to the configuration as identifying a stream.

\hypertarget{config_stream_unique}{%
\subsection{Config\_Stream\_Unique}\label{config_stream_unique}}

Syntax:

Config Stream Unique () Semantics: Set \#Outcome to a name that the
configuration recognizes as a stream name. The name shall not be a name
that the configuration associates with any existing data.

\hypertarget{config_stream_query}{%
\subsection{Config\_Stream\_Query}\label{config_stream_query}}

Syntax: Config Stream Query (Stream) where: Stream is the name of the
stream to be queried. Semantics: Set \#Outcome to `B' if the stream is a
binary stream, or to `C' if it is a character stream.

\hypertarget{config_stream_close}{%
\subsection{Config\_Stream\_Close}\label{config_stream_close}}

Syntax:

Config Stream Close (Stream) where: Stream is the name of the stream to
be closed. Semantics: \#Charout\_Position.Stream and
\#Lineout\_Position.Stream are set to 1 unless the stream has existing
data, in which case they are set ready to write immediately after the
existing data. If this function is unable to position the stream because
the stream is transient then the indicator of the completion response
shall be `T'.

\hypertarget{config-_stream_count}{%
\subsection{Config \_Stream\_Count}\label{config-_stream_count}}

Syntax: Config Stream Count (Stream, Operation, Option) where: Stream is
the name of the stream to be counted. Operation is `CHARS', or `LINES'.

Option is `N' or `C'. Semantics: If the option is `N', \#Outcome is set
to zero if:

\begin{itemize}
\item
  the file is transient and no more characters (or no more lines if the
  Operation is `LINES') are expected to be available, even after
  waiting;
\item
  the file is persistent and no more characters (or no more lines if the
  Operation is `LINES') can be obtained from this stream by
  Config\_Stream\_Charin before use of some function which resets
  \#Charin\_Position.Stream and \#Linein\_Position.Stream.
\end{itemize}

If the option is `N' and \#Outcome is set nonzero, \#Outcome shall be 1,
or be the number of characters (or the number of lines if Operation is
`LINES') which could be read from the stream before resetting.

If the option is `C', \#Outcome is set to zero if:

\begin{itemize}
\item
  the file is transient and no characters (or no lines if the Operation
  is `LINES') are available without waiting;
\item
  the file is persistent and no more characters (or no more lines if the
  Operation is `LINES') can be obtained from this stream by
  Config\_Stream\_Charin before use of some function which resets
  \#Charin\_Position.Stream and \#Linein\_Position.Stream. If the option
  is `C' and \#Outcome is set nonzero, \#Outcome shall be the number of
  characters (or the number of lines if the Operation is `LINES') which
  can be read from the stream without delay and before resetting.
\end{itemize}

\hypertarget{external-variable-pools}{%
\section{External variable pools}\label{external-variable-pools}}

The external variable pools interface consists of functions which the
configuration shall provide to manipulate variables in external variable
pools. See nnn for the VALUE built-in function which uses external
variable pools. The configuration shall provide an external variable
pools mechanism. The following functions shall be provided:

\begin{itemize}
\item
  Config\_Get;
\item
  Config\_Set.
\end{itemize}

The configuration may permit the external variable pools to be altered
in other ways.

\hypertarget{config-get}{%
\subsection{Config Get}\label{config-get}}

Syntax: Config Get (Poolid, Name) where: Poolid is an identification of
the external variable pool. Name is the name of a variable. Semantics:
Get the value of a variable with name Name in the external variable pool
Poolid. Set Outcome to this value. If Poolid does not identify an
external pool provided by this configuration, the indicator of the
completion response is `P'. If Name is not a valid name of a variable in
the external pool, the indicator of the completion response is `F'.

\hypertarget{config-set}{%
\subsection{Config Set}\label{config-set}}

Syntax: Config Set (Poolid, Name, Value)

where: Poolid is an identification of the external variable pool. Name
is the name of a variable. Value is the value to be assigned to the
variable. Semantics: Set a variable with name Name in the external
variable pool Poolid to Value. If Poolid does not identify an external
pool provided by this configuration, the indicator of the completion
response is `P'. If Name is not a valid name of a variable in the
external pool, the indicator of the completion response is `F'.

\hypertarget{configuration-characteristics}{%
\section{Configuration
characteristics}\label{configuration-characteristics}}

The configuration characteristics interface consists of a function which
the configuration shall provide which indicates choices decided by the
configuration.

\hypertarget{config_constants}{%
\subsection{Config\_Constants}\label{config_constants}}

Syntax:

Config Constants () Semantics: Set the values of the following state
variables:

\begin{itemize}
\item
  if there are any built-in functions which do not operate at NUMERIC
  DIGITS 9, then set variables \#Bif\_Digits. (with various tails which
  are the names of those built-in functions) to the values to be used;
\item
  set variables \#Limit\_Digits, \#Limit\_EnvironmentName,
  \#Limit\_ExponentDigits, \#Limit\_Literal, \#Limit\_Messagelnsert,
  \#Limit\_Name, \#Limit\_String, \#Limit\_TraceData to the relevant
  limits. A configuration shall allow a \#Limit\_Messagelnsert value of
  50 to be specified. A configuration shall allow a \#Limit\_TraceData
  value of 250 to be specified;
\item
  set \#Configuration to a string identifying the configuration;
\item
  set \#Version to a string identifying the language processor. It shall
  have five words. Successive words shall be separated by a blank
  character. The first four letters of the first word shall be `REXX'.
  The second word shall be the four characters `5.00'. The last three
  words comprise a date. This shall be in the format which is the
  default for the DATE() built-in function.
\item
  set .nil to a value which compares unequal with any other value that
  can occur in execution.
\item
  set .local .kernel .system?
\end{itemize}

\hypertarget{configuration-routines}{%
\section{Configuration routines}\label{configuration-routines}}

The configuration routines interface consists of functions which the
configuration shall provide which provide functions for a language
processor. The following functions shall be provided:

\begin{itemize}
\item
  Config\_Trace\_Query;
\item
  Config\_Trace\_Input;
\item
  Config\_Trace\_Output;
\item
  Config\_Default\_Input;
\item
  Config\_Default\_Output;
\item
  Config\_Initialization;
\item
  Config\_Termination;
\item
  Config\_Halt\_Query;
\item
  Config\_Halt\_Reset;
\item
  Config\_NoSource;
\item
  Config\_Time;
\item
  Config\_Random\_Seed;
\item
  Config\_Random\_Next.
\end{itemize}

\hypertarget{config_trace_query}{%
\subsection{Config\_Trace\_Query}\label{config_trace_query}}

Syntax: Config Trace Query ()

Semantics: Indicate whether external activity is requesting interactive
tracing. Set \#Outcome to `Yes' if interactive tracing is currently
requested. Otherwise set \#Outcome to `No'.

\hypertarget{config_trace_input}{%
\subsection{Config\_Trace\_Input}\label{config_trace_input}}

Syntax: Config Trace Input ()

Semantics: Set \#Outcome to a value from the source of trace input. The
source of trace input is determined by the configuration.

\hypertarget{config_trace_output}{%
\subsection{Config\_Trace\_Output}\label{config_trace_output}}

Syntax: Config Trace Output (Line)

where: Line is a string. Semantics:

Write String as a line to the destination of trace output. The
destination of trace output is defined by the configuration.

\hypertarget{config-_default_input}{%
\subsection{Config \_Default\_Input}\label{config-_default_input}}

Syntax: Config Default Input ()

Semantics: Set \#Outcome to the value that LINEIN( ) would return.

\hypertarget{config_default_output}{%
\subsection{Config\_Default\_Output}\label{config_default_output}}

Syntax: Config Default Output (Line)

where: Line is a string. Semantics: Write the string as a line in the
manner of LINEOUT( ,Line).

\hypertarget{config_initialization}{%
\subsection{Config\_Initialization}\label{config_initialization}}

Syntax:

Config Initialization ()

Semantics: This function is provided only as a counterpart to
Trap\_Initialization; in itself it does nothing except return the
response. An indicator of `F' gives rise to Msg3.1.

\hypertarget{config_termination}{%
\subsection{Config\_Termination}\label{config_termination}}

Syntax:

Config Termination ()

Semantics: This function is provided only as a counterpart to
Trap\_Termination; in itself it does nothing except return the response.
An indicator of `F' gives rise to Msg2.1.

\hypertarget{config_halt_query}{%
\subsection{Config\_Halt\_Query}\label{config_halt_query}}

Syntax: Config Halt Query ()

Semantics: Indicate whether external activity has requested a HALT
condition to be raised. Set \#Outcome to `Yes if HALT is requested.
Otherwise set \#Outcome to 'No'.

5.12.9 Config \_Halt\_Reset

Syntax: Config Halt Reset ()

Semantics:

Reset the configuration so that further attempts to cause a HALT
condition will be recognized.

\hypertarget{config-_nosource}{%
\subsection{Config \_NoSource}\label{config-_nosource}}

Syntax:

Config NoSource ()

Semantics: Indicate whether the source of the program may or may not be
output by the language processor. Set \#NoSource to `1' to indicate that
the source of the program may not be output by the language processor,
at various points in processing where it would otherwise be output.
Otherwise, set \#NoSource to `0'. A configuration shall allow any
program to be processed in such a way that Config\_NoSource() sets
\#NoSource to `0'. A configuration may allow any program to be processed
in such a way that Config\_NoSource() sets \#NoSource to `1'.

\hypertarget{config_time}{%
\subsection{Config\_Time}\label{config_time}}

Syntax:

Config Time ()

Semantics: Get a time stamp. Set \#Time to a string whose value is the
integer number of microseconds that have elapsed between 00:00:00 on
January first 0001 and the time that Config\_Time is called, at
longitude zero. Values sufficient to allow for any date in the year 9999
shall be supported. The value returned may be an approximation but shall
not be smaller than the value returned by a previous use of the
function.

Set \#Adjust\textless Index ``\#Adjust'' \#``\,'' \textgreater{} to an
integer number of microseconds. \#Adjust\textless Index ``\#Adjust'' \#
â„¢ \textgreater{} reflects the difference between the local date/time and
the date/time corresponding to \#Time. \#Time + \#Adjust\textless Index
``\#Adjust'' \# ``\,'' \textgreater{} is the local date/time.

\hypertarget{config_random_seed}{%
\subsection{Config\_Random\_Seed}\label{config_random_seed}}

Syntax: Config Random Seed (Seed)

where: Seed is a sequence of up to \#Bif\_Digits. RANDOM digits.
Semantics: Set a seed, so that subsequent uses of Config\_Random\_Next
will reproducibly return quasi-random numbers.

\hypertarget{config_random_next}{%
\subsection{Config\_Random\_Next}\label{config_random_next}}

Syntax:

Config Random Next (Min, Max) where: Min is the lower bound, inclusive,
on the number returned in \#Outcome. Max is the upper bound, inclusive,
on the number returned in \#Outcome. Semantics: Set \#Outcome to a
quasi-random nonnegative integer in the range Min to Max.

\hypertarget{config_options}{%
\subsection{Config\_Options}\label{config_options}}

Syntax: Config Options (String) where: String is a string. Semantics: No
effect beyond the effects common to all Config\_ invocations. The value
of the string will have come from an OPTIONS instruction, see nnn.

\hypertarget{traps}{%
\section{Traps}\label{traps}}

The trapping interface consists of functions which may be provided by
the caller of API\_Start (see nnn) as a list of traps. Each trap may be
specified or omitted. The language processor shall invoke a specified
trap before, or instead of, using the corresponding feature of the
language processor itself. This correspondence is implied by the choice
of names; that is, a name beginning Trap\_ will correspond to a name
beginning Config\_ when the remainder of the name is the same.
Corresponding functions are called with the same interface, with one
exception. The exception is that a trap may return a null string. When a
trap returns a null string, the corresponding Config\_ function is
invoked; otherwise the invocation of the trap replaces the potential
invocation of the Config\_ function. In the rest of this standard, the
trapping mechanism is not shown explicitly. It is implied by the use of
a Config\_ function. The names of the traps are

\begin{itemize}
\item
  Trap\_Command;
\item
  Trap\_ExternalRoutine;
\item
  Trap\_Push;
\item
  Trap\_Queue;
\item
  Trap\_Pull;
\item
  Trap\_Queued;
\item
  Trap\_Trace\_Query;
\item
  Trap\_Trace\_Input;
\item
  Trap\_Trace\_Output;
\item
  Trap\_Default\_Input;
\item
  Trap\_Default\_Output;
\item
  Trap\_Initialization;
\item
  Trap\_Termination;
\item
  Trap\_Halt\_Query;
\item
  Trap\_Halt\_Reset.
\end{itemize}

\hypertarget{variable-pool}{%
\section{Variable pool}\label{variable-pool}}

How does this fit with variables as properties?

The variable pool interface consists of functions which the
configuration shall provide to manipulate the variables and to obtain
some characteristics of a Rexx program.

These functions can be called from programs not written in Rexx \_
commands and external routines invoked from a Rexx program, or traps
invoked from the language processor.

All the functions comprising the variable pool interface shall return
with an indication of whether an error occurred. They shall return
indicating an error and have no other effect, if \#API\_Enabled has a
value of `0' or if the arguments to them fail to meet the defined
syntactic constraints.

These functions interact with the processing of clauses. To define this
interaction, the functions are described here in terms of the processing
of variables, see nnn.

Some of these functions have an argument which is a symbol. A symbol is
a string. The content of the string shall meet the syntactic constraints
of the left hand side of an assignment. Conversion to uppercase and
substitution in compound symbols occurs as it does for the left hand
side of an assignment. The symbol identifies the variable to be operated
upon.

Some of the functions have an argument which is a direct symbol. A
direct symbol is a string. The content of this string shall meet the
syntactic constraints of a VAR\_SYMBOL in uppercase with no periods or
it shall be the concatenation of a part meeting the syntactic
constraints of a stem in uppercase, and a part that is any string. In
the former case the symbol identifies the variable to be operated upon.
In the latter case the variable to be operated on is one with the
specified stem and a tail which is the remainder of the direct symbol.

Functions that have an argument which is symbol or direct symbol shall
return an indication of whether the identified variable existed before
the function was executed. Clause nnn defines functions which manipulate
Rexx variable pools. Where possible the functions comprising the
variable pool interface are described in terms of the appropriate
invocations of the functions defined in nnn. The first parameter on
these calls is the state variable \#Pool. If these Var\_ functions do
not return an indicator `N', `R', or `D' then the API function shall
return an error indication.

\hypertarget{api-set}{%
\subsection{API Set}\label{api-set}}

Syntax: API Set(Symbol, Value) where: Symbol is a symbol. Value is the
string whose value is to be assigned to the variable. Semantics: Assign
the value of Value to the variable identified by Symbol. If Symbol
contains no periods or contains one period as its last character: Var\_
Set(\#Pool, Symbol, `0', Value) Otherwise: Var \_Set(\#Pool, \#Symbol,
`1', Value) where: \#Symbol is Symbol after any replacements in the tail
as described by nnn.

\hypertarget{api-value}{%
\subsection{API Value}\label{api-value}}

Syntax: API Value (Symbol)

where: Symbol is a symbol. Semantics: Return the value of the variable
identified by Symbol. If Symbol contains no periods or contains one

period as its last character this is the value of \#Outcome after: Var
\_Value(\#Pool, Symbol, `0')

Otherwise the value of \#Outcome after: Var Value(\#Pool, \#Symbol, `1')
where: \#Symbol is Symbol after any replacements in the tail as
described by nnn.

\hypertarget{api_drop}{%
\subsection{API\_Drop}\label{api_drop}}

Syntax: API Drop (Symbol)

where: Symbol is a symbol. Semantics: Drop the variable identified by
Symbol. If Symbol contains no periods or contains one period as its last
character: Var Drop(\#Pool, Symbol, `0') Otherwise: Var Drop(\#Pool,
\#Symbol, `1') where: \#Symbol is Symbol after any replacements in the
tail as described by nnn.

\hypertarget{api-setdirect}{%
\subsection{API SetDirect}\label{api-setdirect}}

Syntax: API SetDirect (Symbol, Value)

where: Symbol is a direct symbol. Value is the string whose value is to
be assigned to the variable. Semantics:

Assign the value of Value to the variable identified by Symbol. If the
Symbol contains no period: Var\_ Set(\#Pool, Symbol, `0', Value)

Otherwise: Var\_ Set(\#Pool, Symbol, `1', Value)

\hypertarget{api_valuedirect}{%
\subsection{API\_ValueDirect}\label{api_valuedirect}}

Syntax: API ValueDirect (Symbol)

where: Symbol is a direct symbol. Semantics: Return the value of the
variable identified by Symbol. If the Symbol contains no period: Var
\_Value(\#Pool, Symbol, `0') Otherwise: Var \_Value(\#Pool, Symbol, `1')

\hypertarget{api-dropdirect}{%
\subsection{API DropDirect}\label{api-dropdirect}}

Syntax: API DropDirect (Symbol)

where: Symbol is a direct symbol. Semantics:

Drop the variable identified by Symbol. If the Symbol contains no
period: Var Drop(\#Pool, Symbol, `0')

Otherwise: Var Drop(\#Pool, Symbol, `1')

\hypertarget{api-valueother}{%
\subsection{API ValueOther}\label{api-valueother}}

Syntax: API ValueOther (Qualifier) where: Qualifier is an indication
distinguishing the result to be returned including any necessary further
qualification. Semantics: Return characteristics of the program,
depending on the value of Qualifier. The possibilities for the value to
be returned are:

\begin{itemize}
\item
  the value of \#Source;
\item
  the value of \#Version;
\item
  the largest value of n such that \#ArgExists.1.n is `1', see nnn;
\item
  the value of \#Arg.1.n where n is an integer value provided as input.
\end{itemize}

\hypertarget{api-next}{%
\subsection{API Next}\label{api-next}}

Syntax: API Next ()

Semantics:

Returns both the name and the value of some variable in the variable
pool that does not have the attribute `dropped' or the attribute
`implicit' and is not a stem; alternatively return an indication that
there is no suitable name to return. When API\_Next is called it will
return a name that has not previously been returned; the order is
undefined. This process of returning different names will restart
whenever the Rexx processor executes Var\_Reset.

\hypertarget{api-nextvariable}{%
\subsection{API NextVariable}\label{api-nextvariable}}

Syntax: API NextVariable()

Semantics:

Returns both the name and the value of some variable in the variable
pool that does not have the attribute `dropped' or the attribute
`implicit'; alternatively, return an indication that there is no
suitable name to return. When API NextVariable is called it will return
data about a variable that has not previously been returned; the order
is undefined. This process of returning different names will restart
whenever the Rexx processor executes Var\_Reset. In addition to the name
and value, an indication of whether the variable was `tailed' will be
returned.
